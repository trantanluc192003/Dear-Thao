<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Dear Thảo</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #fffaf0;
      font-family: 'Courier New', Courier, monospace;
      overflow: hidden;
    }

    #startScreen {
      position: fixed;
      width: 100vw;
      height: 100vh;
      background-color: #fffaf0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 10;
    }

    #startScreen img {
      width: 200px;
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    #startBtn {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      background: pink;
      cursor: pointer;
    }

    #content {
      display: none;
      height: 100vh;
      width: 100vw;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      flex-wrap: nowrap;
      overflow: hidden;
    }

    #message {
      width: 50%;
      padding: 40px;
      color: deeppink;
      white-space: pre-line;
      font-size: 20px;
      overflow-y: auto;
      box-sizing: border-box;
    }

    #treeContainer {
      width: 50%;
      display: flex;
      align-items: end;
      justify-content: end;
      padding: 40px;
      box-sizing: border-box;
      position: relative;
    }

    #heartTree {
      height: 60vh;
    }

    .fallingHeart {
      position: absolute;
      pointer-events: none;
      user-select: none;
      width: 40px;
      height: 40px;
      animation: fallAndSpin 6s ease-in-out forwards;
    }

    @keyframes fallAndSpin {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translate(-150px, 600px) rotate(720deg);
        opacity: 0;
      }
    }

    .cursor {
      display: inline-block;
      width: 10px;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body>

<div id="startScreen">
  <img src="tim.png" alt="Heart" />
  <button id="startBtn">Em click vào đây nhé</button>
</div>

<div id="content">
  <div id="message"></div>
  <div id="treeContainer">
    <img src="caytimne.png" id="heartTree" alt="Heart Tree" />
  </div>
</div>

<audio id="bgMusic" src="nhac.mp3"></audio>

<script>
  const message = `Gửi Thảo,

Hôm nay anh có những lời này muốn nói với em……

Thật ra thì trước anh học khóa Gateway trễ, anh học buổi thứ 20 thì phải, và sau buổi 21 cũng là buổi đầu tiên mà anh gặp em, lúc đó tự nhiên anh thấy ở em có điều gì đó rất thu hút đối với anh, và từ những buổi đi học sau anh bắt đầu để ý đến em, và càng ngày anh càng bị thu hút hơn ở em bởi nét xinh đẹp đơn giản và rất tự nhiên của em, anh thấy em không tô son, không makeup nhiều nhưng em vẫn xinh một cách giản dị, và thêm nữa anh thấy từ giọng nói đến cách em nói chuyện với mọi người, sự lễ phép đối với thầy thật sự rất dễ thương luôn, em thật sự là mẫu người mà anh thích, từ đó anh cảm thấy thích em rồi. Anh bắt đầu có động lực đi học hơn, đi học được thấy em dù chẳng nói gì, và chắc lúc đó em cũng không biết anh là ai. 

Nhưng thật sự thì anh rất ngại với con gái á, nên anh cũng không dám làm quen với em, sợ em nghĩ anh thế này thế kia. Nhưng rồi cuối khóa Pathway, anh biết là sắp tới không còn cơ hội để gặp em nữa nên anh mới lấy cam đảm mà gửi kết bạn với em với lí do hỏi bài học, thật sự lúc nhấn gửi mà anh run lắm luôn. Lúc em accept thì anh rất vui, nhưng anh nói thật anh chưa từng quen ai trước đây, nên anh cũng không biết bắt chuyện với con gái thế nào, anh muốn nhắn tin trò chuyện với em nhưng trong đầu anh lại không biết nên nhắn gì, bản thân anh thuộc kiểu người gọi là sao ta, như kiểu goodboy á, anh ít nói lắm, lời lẻ cũng nhạt, thường anh hay quan tâm những người quanh anh bằng hành động hơn

Có những lần anh nhắn tin cho em, em chỉ seen không có rep lại, anh cũng thấy hơi buồn, nhưng anh sợ hơn là buồn, sợ em nghĩ anh phiền thế này thế kia hơn. 

Hôm nay anh viết những lời này để muốn nói cho em biết về tình cảm của anh, anh thật sự rất thích em, dù chưa biết gì nhiều về em, nhưng qua sự giản dị tự nhiên và cách nói chuyện thì anh thấy em là người mà không nên bỏ lỡ nếu có cơ hội, anh nói những lời này ra để cho em biết về tình cảm của anh, anh hi vọng em có thể cho anh một cơ hội để tìm hiểu hơn về em, và em cũng sẽ hiểu về anh, anh sẽ làm những điều tốt nhất anh có thể, em cứ suy nghĩ nhé, nếu em đồng ý cho anh một cơ hội thì hãy nhắn gì đó qua Zalo cho anh biết nhé, còn nếu em không đồng ý thì em chỉ cần xem thôi không cần trả lời gì cả, anh sẽ hiểu và không làm phiền em nữa đâu. 

Thật sự thì hôm nay anh đã lấy hết can đảm để nói ra tình cảm của anh đó, anh chỉ muốn nếu lỡ không thành công thì ít ra anh cũng đã dũng cảm để nói ra tình cảm của mình với người mà anh thích ❤️. 
`;

  const startScreen = document.getElementById('startScreen');
  const content = document.getElementById('content');
  const startBtn = document.getElementById('startBtn');
  const messageBox = document.getElementById('message');
  const heartTree = document.getElementById('heartTree');
  const bgMusic = document.getElementById('bgMusic');

  startBtn.onclick = () => {
    startScreen.style.display = 'none';
    content.style.display = 'flex';
    typeWriterWithPause(messageBox, message);

    setTimeout(() => {
      bgMusic.volume = 0.3;
      bgMusic.play();
    }, 10000);

    setInterval(() => {
      const count = Math.floor(Math.random() * 2) + 1;
      for (let i = 0; i < count; i++) {
        createFallingHeart();
      }
    }, 3000 + Math.random() * 2000);
  };

  function typeWriterWithPause(element, text, i = 0) {
    if (i <= text.length) {
      element.innerHTML = text.substring(0, i) + '<span class="cursor">|</span>';
      element.scrollTop = element.scrollHeight;
      const char = text.charAt(i - 1);
      let delay = 50;

      if (char === ',' || char === '…') delay = 500 + Math.random() * 300;
      else if (char === '.') delay = 700 + Math.random() * 400;
      else if (char === '\n') delay = 600 + Math.random() * 300;
      else if (char === '?') delay = 800 + Math.random() * 400;

      setTimeout(() => typeWriterWithPause(element, text, i + 1), delay);
    } else {
      element.innerHTML = text;
    }
  }

  function createFallingHeart() {
    const rect = heartTree.getBoundingClientRect();
    
    const heart = document.createElement('img');
    heart.src = 'tym.png';
    heart.className = 'fallingHeart';

    // Tạo điểm rơi trong elip giữa tán cây
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height * 0.35; // Tán cây chiếm khoảng 60% trên
    const radiusX = rect.width * 0.45; // độ rộng tán cây
    const radiusY = rect.height * 0.3; // độ cao tán cây

    let xOffset, yOffset;
    do {
      xOffset = (Math.random() * 2 - 1) * radiusX;
      yOffset = (Math.random() * 2 - 1) * radiusY;
    } while ((xOffset ** 2) / (radiusX ** 2) + (yOffset ** 2) / (radiusY ** 2) > 1); // đảm bảo trong elip

    const startX = centerX + xOffset;
    const startY = centerY + yOffset;

    heart.style.left = `${startX}px`;
    heart.style.top = `${startY}px`;

    document.body.appendChild(heart);

    setTimeout(() => heart.remove(), 7000);
  }

</script>

</body>
</html>
