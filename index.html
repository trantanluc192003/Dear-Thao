<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Dear Thảo</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #fffaf0;
      font-family: 'Courier New', Courier, monospace;
      overflow: hidden;
    }
    #startScreen {
      position: fixed;
      width: 100vw;
      height: 100vh;
      background-color: #fffaf0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 10;
    }
    #startScreen img {
      width: 200px;
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    #startBtn {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      background: pink;
      cursor: pointer;
    }

    #content {
      display: none;
      height: 100vh;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      padding: 40px;
      box-sizing: border-box;
      position: relative;
    }

    #message {
      width: 50%;
      color: deeppink;
      white-space: pre-line;
      font-size: 20px;
      z-index: 1;
    }

    #treeContainer {
      width: 50%;
      position: relative;
      display: flex;
      align-items: end;
      justify-content: end;
      z-index: 0;
    }

    #heartTree {
      height: 80vh;
    }

    .fallingHeart {
      position: absolute;
      pointer-events: none;
      user-select: none;
      width: 40px;
      height: 40px;
      animation: fall 6s linear forwards;
    }

    @keyframes fall {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translate(-200px, 700px) rotate(360deg);
        opacity: 0;
      }
    }

    .cursor {
      display: inline-block;
      width: 10px;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body>

<!-- Nhạc nền -->
<audio id="bgMusic" src="nhac.mp3" loop></audio>

<div id="startScreen">
  <img src="tim.png" alt="Heart">
  <button id="startBtn">Click here</button>
</div>

<div id="content">
  <div id="message"></div>
  <div id="treeContainer">
    <img src="caytimne.png" id="heartTree" alt="Heart Tree">
  </div>
</div>

<script>
  const message = `Thảo ơi,

Tớ có một điều muốn nói với cậu từ lâu rồi…
Tớ thích cậu, không chỉ một chút, mà là rất nhiều.

Mỗi khi cậu cười, cả thế giới như sáng bừng lên trong mắt tớ.

Tớ không biết tương lai ra sao, nhưng tớ muốn được cùng cậu viết nên nó.

Cậu đồng ý làm người yêu tớ nhé? 💗`;

  const startScreen = document.getElementById('startScreen');
  const content = document.getElementById('content');
  const startBtn = document.getElementById('startBtn');
  const messageBox = document.getElementById('message');
  const heartTree = document.getElementById('heartTree');
  const bgMusic = document.getElementById('bgMusic');

  startBtn.onclick = () => {
    startScreen.style.display = 'none';
    content.style.display = 'flex';
    typeWriterWithPause(messageBox, message);
    setInterval(() => {
      const count = Math.floor(Math.random() * 2) + 1; // 1–2 tim mỗi lần
      for (let i = 0; i < count; i++) {
        createFallingHeart();
      }
    }, 3000 + Math.random() * 2000);
  };

  function typeWriterWithPause(element, text, i = 0) {
    if (i <= text.length) {
      element.innerHTML = text.substring(0, i) + '<span class="cursor">|</span>';
      const char = text.charAt(i - 1);
      let delay = 50;

      if (char === ',' || char === '…') delay = 500 + Math.random() * 300;
      else if (char === '.') delay = 700 + Math.random() * 400;
      else if (char === '\n') delay = 600 + Math.random() * 300;
      else if (char === '?') delay = 800 + Math.random() * 400;

      setTimeout(() => typeWriterWithPause(element, text, i + 1), delay);
    } else {
      element.innerHTML = text;
      setTimeout(() => {
        bgMusic.volume = 0.3;  // Giảm âm lượng
        bgMusic.play();
      }, 5000);
    }
  }

  function createFallingHeart() {
    const rect = heartTree.getBoundingClientRect();
    const heart = document.createElement('img');
    heart.src = 'tym.png';
    heart.className = 'fallingHeart';

    const startX = rect.left + Math.random() * rect.width;
    const startY = rect.top + Math.random() * rect.height;

    heart.style.left = `${startX}px`;
    heart.style.top = `${startY}px`;

    document.body.appendChild(heart);

    setTimeout(() => heart.remove(), 6000);
  }
</script>

</body>
</html>
